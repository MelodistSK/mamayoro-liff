<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>ä¼šå“¡ç™»éŒ² - ã¾ã¾ã‚ˆã‚äººæç´¹ä»‹</title>
    <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Hiragino Sans', 'Hiragino Kaku Gothic ProN', 'Yu Gothic', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 500px;
            margin: 0 auto;
        }
        
        .logo {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .logo h1 {
            color: white;
            font-size: 2em;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .logo p {
            color: rgba(255,255,255,0.9);
            margin-top: 10px;
            font-size: 0.9em;
        }
        
        .card {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            margin-bottom: 20px;
        }
        
        h2 {
            color: #333;
            font-size: 1.5em;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .info-box {
            background: #f0f7ff;
            border-left: 4px solid #667eea;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 25px;
            font-size: 0.9em;
            color: #555;
        }
        
        .privacy-content {
            max-height: 300px;
            overflow-y: auto;
            padding: 20px;
            background: #f9f9f9;
            border-radius: 10px;
            margin-bottom: 20px;
            font-size: 0.85em;
            line-height: 1.8;
        }
        
        .privacy-content h3 {
            font-size: 1em;
            margin: 15px 0 10px 0;
            color: #333;
        }
        
        .privacy-content p {
            margin-bottom: 10px;
            color: #555;
        }
        
        .consent-check {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 20px 0;
            padding: 15px;
            background: #fff5f5;
            border-radius: 10px;
        }
        
        .consent-check input[type="checkbox"] {
            width: 20px;
            height: 20px;
            accent-color: #667eea;
        }
        
        .consent-check label {
            font-size: 0.95em;
            color: #333;
        }
        
        .section-title {
            font-size: 1.1em;
            font-weight: 600;
            color: #667eea;
            margin: 30px 0 15px 0;
            padding-bottom: 10px;
            border-bottom: 2px solid #e8ebff;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #333;
            font-size: 0.95em;
        }
        
        .form-group label .required {
            color: #e74c3c;
            font-size: 0.8em;
            margin-left: 5px;
        }
        
        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        
        input[type="text"],
        input[type="email"],
        input[type="tel"],
        input[type="date"],
        select {
            width: 100%;
            padding: 14px 16px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 16px;
            transition: border-color 0.3s, box-shadow 0.3s;
            background: #fafafa;
        }
        
        input:focus,
        select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
            background: white;
        }
        
        .radio-group {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        .radio-option {
            flex: 1;
            min-width: 100px;
        }
        
        .radio-option input[type="radio"] {
            display: none;
        }
        
        .radio-option label {
            display: block;
            padding: 12px 20px;
            background: #f5f5f5;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.95em;
        }
        
        .radio-option input[type="radio"]:checked + label {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }
        
        .btn {
            width: 100%;
            padding: 16px;
            border: none;
            border-radius: 12px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 20px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .btn-primary:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
        }
        
        .btn-primary:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
        
        .btn-secondary {
            background: #f5f5f5;
            color: #666;
            border: 2px solid #e0e0e0;
        }
        
        .btn-secondary:hover {
            background: #eee;
        }
        
        .page {
            display: none;
        }
        
        .page.active {
            display: block;
        }
        
        /* ãƒšãƒ¼ã‚¸4: å®Œäº†ç”»é¢ */
        .complete-icon {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .complete-icon .checkmark {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto;
            animation: scaleIn 0.5s ease-out;
        }
        
        .complete-icon .checkmark svg {
            width: 40px;
            height: 40px;
            fill: white;
        }
        
        @keyframes scaleIn {
            0% { transform: scale(0); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }
        
        .complete-message {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .complete-message h2 {
            color: #333;
            margin-bottom: 15px;
        }
        
        .complete-message p {
            color: #666;
            line-height: 1.8;
        }
        
        .info-card {
            background: #f8f9ff;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 25px;
        }
        
        .info-card h3 {
            color: #667eea;
            font-size: 1em;
            margin-bottom: 15px;
        }
        
        .info-card p {
            color: #555;
            font-size: 0.9em;
            line-height: 1.6;
        }
        
        /* ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚° */
        .loading {
            text-align: center;
            padding: 60px 20px;
        }
        
        .spinner {
            width: 50px;
            height: 50px;
            border: 4px solid #f0f0f0;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .loading p {
            color: #666;
            font-size: 1.1em;
        }
        
        /* ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ */
        .error-message {
            background: #fff5f5;
            border: 1px solid #ffcccc;
            color: #e74c3c;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            display: none;
        }
        
        .error-message.active {
            display: block;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="logo">
            <h1>ğŸŒ¸ ã¾ã¾ã‚ˆã‚</h1>
            <p>ã‚·ãƒ³ã‚°ãƒ«ãƒã‚¶ãƒ¼ã®ã‚­ãƒ£ãƒªã‚¢ã‚’å…¨åŠ›ã‚µãƒãƒ¼ãƒˆ</p>
        </div>
        
        <!-- ãƒšãƒ¼ã‚¸1: åŒæ„ç”»é¢ -->
        <div class="page active" id="page1">
            <div class="card">
                <h2>å€‹äººæƒ…å ±ã®å–ã‚Šæ‰±ã„ã«ã¤ã„ã¦</h2>
                
                <div class="info-box">
                    ä¼šå“¡ç™»éŒ²ã®å‰ã«ã€å€‹äººæƒ…å ±ã®å–ã‚Šæ‰±ã„ã«ã¤ã„ã¦ã”ç¢ºèªãã ã•ã„ã€‚
                </div>
                
                <div class="privacy-content">
                    <h3>1. å€‹äººæƒ…å ±ã®åˆ©ç”¨ç›®çš„</h3>
                    <p>ã”æä¾›ã„ãŸã ã„ãŸå€‹äººæƒ…å ±ã¯ã€ä»¥ä¸‹ã®ç›®çš„ã§åˆ©ç”¨ã„ãŸã—ã¾ã™ã€‚</p>
                    <p>ãƒ»æ±‚äººæƒ…å ±ã®ã”æ¡ˆå†…<br>ãƒ»ã‚­ãƒ£ãƒªã‚¢ã‚«ã‚¦ãƒ³ã‚»ãƒªãƒ³ã‚°ã®å®Ÿæ–½<br>ãƒ»é¢è«‡æ—¥ç¨‹ã®èª¿æ•´<br>ãƒ»ã‚µãƒ¼ãƒ“ã‚¹å‘ä¸Šã®ãŸã‚ã®åˆ†æ</p>
                    
                    <h3>2. ç¬¬ä¸‰è€…ã¸ã®æä¾›</h3>
                    <p>ã”æœ¬äººã®åŒæ„ãªãã€å€‹äººæƒ…å ±ã‚’ç¬¬ä¸‰è€…ã«æä¾›ã™ã‚‹ã“ã¨ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ãŸã ã—ã€æ±‚äººä¼æ¥­ã¸ã®å¿œå‹Ÿæ™‚ã«ã¯ã€å¿…è¦ãªæƒ…å ±ã‚’æä¾›ã™ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚</p>
                    
                    <h3>3. å€‹äººæƒ…å ±ã®é–‹ç¤ºãƒ»è¨‚æ­£ãƒ»å‰Šé™¤</h3>
                    <p>ã”æœ¬äººã‹ã‚‰ã®é–‹ç¤ºã€è¨‚æ­£ã€å‰Šé™¤ã®ã”è«‹æ±‚ã«ã¯ã€é©åˆ‡ã«å¯¾å¿œã„ãŸã—ã¾ã™ã€‚</p>
                    
                    <h3>4. å€‹äººæƒ…å ±ã®ç®¡ç†</h3>
                    <p>å€‹äººæƒ…å ±ã®æ¼æ´©ã€ç´›å¤±ã€ç ´å£Šç­‰ã‚’é˜²æ­¢ã™ã‚‹ãŸã‚ã€é©åˆ‡ãªå®‰å…¨ç®¡ç†æªç½®ã‚’è¬›ã˜ã¾ã™ã€‚</p>
                    
                    <h3>5. ãŠå•ã„åˆã‚ã›çª“å£</h3>
                    <p>å€‹äººæƒ…å ±ã«é–¢ã™ã‚‹ãŠå•ã„åˆã‚ã›ã¯ã€æ‹…å½“è€…ã¾ã§ã”é€£çµ¡ãã ã•ã„ã€‚</p>
                </div>
                
                <div class="consent-check">
                    <input type="checkbox" id="consent" onchange="checkConsent()">
                    <label for="consent">ä¸Šè¨˜ã®å€‹äººæƒ…å ±ã®å–ã‚Šæ‰±ã„ã«åŒæ„ã—ã¾ã™</label>
                </div>
                
                <button class="btn btn-primary" id="agreeBtn" disabled onclick="showPage(2)">
                    åŒæ„ã—ã¦ç™»éŒ²ã¸é€²ã‚€
                </button>
            </div>
        </div>
        
        <!-- ãƒšãƒ¼ã‚¸2: ç™»éŒ²ãƒ•ã‚©ãƒ¼ãƒ  -->
        <div class="page" id="page2">
            <div class="card">
                <h2>ä¼šå“¡ç™»éŒ²</h2>
                
                <div class="error-message" id="errorMessage"></div>
                
                <form id="registrationForm" onsubmit="submitForm(event)">
                    <div class="section-title">ğŸ‘¤ åŸºæœ¬æƒ…å ±</div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label>å§“ <span class="required">å¿…é ˆ</span></label>
                            <input type="text" id="lastName" name="lastName" required placeholder="å±±ç”°">
                        </div>
                        <div class="form-group">
                            <label>å <span class="required">å¿…é ˆ</span></label>
                            <input type="text" id="firstName" name="firstName" required placeholder="èŠ±å­">
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label>ã‚»ã‚¤</label>
                            <input type="text" id="lastNameKana" name="lastNameKana" placeholder="ãƒ¤ãƒãƒ€">
                        </div>
                        <div class="form-group">
                            <label>ãƒ¡ã‚¤</label>
                            <input type="text" id="firstNameKana" name="firstNameKana" placeholder="ãƒãƒŠã‚³">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>ç”Ÿå¹´æœˆæ—¥ <span class="required">å¿…é ˆ</span></label>
                        <input type="date" id="birthDate" name="birthDate" required>
                    </div>
                    
                    <div class="form-group">
                        <label>æ€§åˆ¥ <span class="required">å¿…é ˆ</span></label>
                        <div class="radio-group">
                            <div class="radio-option">
                                <input type="radio" id="female" name="gender" value="å¥³æ€§" required>
                                <label for="female">å¥³æ€§</label>
                            </div>
                            <div class="radio-option">
                                <input type="radio" id="male" name="gender" value="ç”·æ€§">
                                <label for="male">ç”·æ€§</label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="section-title">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ å®¶æ—æ§‹æˆ</div>
                    
                    <div class="form-group">
                        <label>å©šå§»çŠ¶æ³ <span class="required">å¿…é ˆ</span></label>
                        <div class="radio-group">
                            <div class="radio-option">
                                <input type="radio" id="marital_divorce" name="maritalStatus" value="ã‚·ãƒ³ã‚°ãƒ«ï¼ˆé›¢å©šï¼‰" required>
                                <label for="marital_divorce">ã‚·ãƒ³ã‚°ãƒ«ï¼ˆé›¢å©šï¼‰</label>
                            </div>
                            <div class="radio-option">
                                <input type="radio" id="marital_single" name="maritalStatus" value="ã‚·ãƒ³ã‚°ãƒ«ï¼ˆæœªå©šï¼‰">
                                <label for="marital_single">ã‚·ãƒ³ã‚°ãƒ«ï¼ˆæœªå©šï¼‰</label>
                            </div>
                            <div class="radio-option">
                                <input type="radio" id="marital_married" name="maritalStatus" value="æ—¢å©š">
                                <label for="marital_married">æ—¢å©š</label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>ãŠå­æ§˜ã®äººæ•° <span class="required">å¿…é ˆ</span></label>
                        <select id="childrenCount" name="childrenCount" required>
                            <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                            <option value="1äºº">1äºº</option>
                            <option value="2äºº">2äºº</option>
                            <option value="3äºº">3äºº</option>
                            <option value="4äºº">4äºº</option>
                            <option value="5äººä»¥ä¸Š">5äººä»¥ä¸Š</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label>æœ€ã‚‚å¹´é½¢ãŒä½ã„ãŠå­æ§˜ã®ç”Ÿã¾ã‚Œå¹´ <span class="required">å¿…é ˆ</span></label>
                        <select id="youngestChildYear" name="youngestChildYear" required>
                            <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                            <option value="2025å¹´">2025å¹´</option>
                            <option value="2024å¹´">2024å¹´</option>
                            <option value="2023å¹´">2023å¹´</option>
                            <option value="2022å¹´">2022å¹´</option>
                            <option value="2021å¹´">2021å¹´</option>
                            <option value="2020å¹´">2020å¹´</option>
                            <option value="2019å¹´">2019å¹´</option>
                            <option value="2018å¹´">2018å¹´</option>
                            <option value="2017å¹´">2017å¹´</option>
                            <option value="2016å¹´">2016å¹´</option>
                            <option value="2015å¹´">2015å¹´</option>
                            <option value="2014å¹´">2014å¹´</option>
                            <option value="2013å¹´">2013å¹´</option>
                            <option value="2012å¹´">2012å¹´</option>
                            <option value="2011å¹´">2011å¹´</option>
                            <option value="2010å¹´">2010å¹´</option>
                            <option value="2009å¹´">2009å¹´</option>
                            <option value="2008å¹´">2008å¹´</option>
                            <option value="2007å¹´">2007å¹´</option>
                            <option value="2006å¹´">2006å¹´</option>
                            <option value="2005å¹´">2005å¹´</option>
                            <option value="2004å¹´ä»¥å‰">2004å¹´ä»¥å‰</option>
                        </select>
                    </div>
                    
                    <div class="section-title">ğŸ“ é€£çµ¡å…ˆ</div>
                    
                    <div class="form-group">
                        <label>é›»è©±ç•ªå· <span class="required">å¿…é ˆ</span></label>
                        <input type="tel" id="phone" name="phone" required placeholder="090-1234-5678">
                    </div>
                    
                    <div class="form-group">
                        <label>ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹</label>
                        <input type="email" id="email" name="email" placeholder="example@email.com">
                    </div>
                    
                    <div class="form-group">
                        <label>ãŠä½ã¾ã„ã®éƒ½é“åºœçœŒ</label>
                        <select id="prefecture" name="prefecture">
                            <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                            <option value="åŒ—æµ·é“">åŒ—æµ·é“</option>
                            <option value="é’æ£®çœŒ">é’æ£®çœŒ</option>
                            <option value="å²©æ‰‹çœŒ">å²©æ‰‹çœŒ</option>
                            <option value="å®®åŸçœŒ">å®®åŸçœŒ</option>
                            <option value="ç§‹ç”°çœŒ">ç§‹ç”°çœŒ</option>
                            <option value="å±±å½¢çœŒ">å±±å½¢çœŒ</option>
                            <option value="ç¦å³¶çœŒ">ç¦å³¶çœŒ</option>
                            <option value="èŒ¨åŸçœŒ">èŒ¨åŸçœŒ</option>
                            <option value="æ ƒæœ¨çœŒ">æ ƒæœ¨çœŒ</option>
                            <option value="ç¾¤é¦¬çœŒ">ç¾¤é¦¬çœŒ</option>
                            <option value="åŸ¼ç‰çœŒ">åŸ¼ç‰çœŒ</option>
                            <option value="åƒè‘‰çœŒ">åƒè‘‰çœŒ</option>
                            <option value="æ±äº¬éƒ½">æ±äº¬éƒ½</option>
                            <option value="ç¥å¥ˆå·çœŒ">ç¥å¥ˆå·çœŒ</option>
                            <option value="æ–°æ½ŸçœŒ">æ–°æ½ŸçœŒ</option>
                            <option value="å¯Œå±±çœŒ">å¯Œå±±çœŒ</option>
                            <option value="çŸ³å·çœŒ">çŸ³å·çœŒ</option>
                            <option value="ç¦äº•çœŒ">ç¦äº•çœŒ</option>
                            <option value="å±±æ¢¨çœŒ">å±±æ¢¨çœŒ</option>
                            <option value="é•·é‡çœŒ">é•·é‡çœŒ</option>
                            <option value="å²é˜œçœŒ">å²é˜œçœŒ</option>
                            <option value="é™å²¡çœŒ">é™å²¡çœŒ</option>
                            <option value="æ„›çŸ¥çœŒ">æ„›çŸ¥çœŒ</option>
                            <option value="ä¸‰é‡çœŒ">ä¸‰é‡çœŒ</option>
                            <option value="æ»‹è³€çœŒ">æ»‹è³€çœŒ</option>
                            <option value="äº¬éƒ½åºœ">äº¬éƒ½åºœ</option>
                            <option value="å¤§é˜ªåºœ">å¤§é˜ªåºœ</option>
                            <option value="å…µåº«çœŒ">å…µåº«çœŒ</option>
                            <option value="å¥ˆè‰¯çœŒ">å¥ˆè‰¯çœŒ</option>
                            <option value="å’Œæ­Œå±±çœŒ">å’Œæ­Œå±±çœŒ</option>
                            <option value="é³¥å–çœŒ">é³¥å–çœŒ</option>
                            <option value="å³¶æ ¹çœŒ">å³¶æ ¹çœŒ</option>
                            <option value="å²¡å±±çœŒ">å²¡å±±çœŒ</option>
                            <option value="åºƒå³¶çœŒ">åºƒå³¶çœŒ</option>
                            <option value="å±±å£çœŒ">å±±å£çœŒ</option>
                            <option value="å¾³å³¶çœŒ">å¾³å³¶çœŒ</option>
                            <option value="é¦™å·çœŒ">é¦™å·çœŒ</option>
                            <option value="æ„›åª›çœŒ">æ„›åª›çœŒ</option>
                            <option value="é«˜çŸ¥çœŒ">é«˜çŸ¥çœŒ</option>
                            <option value="ç¦å²¡çœŒ">ç¦å²¡çœŒ</option>
                            <option value="ä½è³€çœŒ">ä½è³€çœŒ</option>
                            <option value="é•·å´çœŒ">é•·å´çœŒ</option>
                            <option value="ç†Šæœ¬çœŒ">ç†Šæœ¬çœŒ</option>
                            <option value="å¤§åˆ†çœŒ">å¤§åˆ†çœŒ</option>
                            <option value="å®®å´çœŒ">å®®å´çœŒ</option>
                            <option value="é¹¿å…å³¶çœŒ">é¹¿å…å³¶çœŒ</option>
                            <option value="æ²–ç¸„çœŒ">æ²–ç¸„çœŒ</option>
                        </select>
                    </div>
                    
                    <div class="section-title">ğŸ’¼ è»¢è·æ„å‘</div>
                    
                    <div class="form-group">
                        <label>è»¢è·å¸Œæœ›æ™‚æœŸ <span class="required">å¿…é ˆ</span></label>
                        <select id="desiredStartDate" name="desiredStartDate" required>
                            <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                            <option value="ã™ãã«ã§ã‚‚ï¼ˆ1ãƒ¶æœˆä»¥å†…ï¼‰">ã™ãã«ã§ã‚‚ï¼ˆ1ãƒ¶æœˆä»¥å†…ï¼‰</option>
                            <option value="3ãƒ¶æœˆä»¥å†…">3ãƒ¶æœˆä»¥å†…</option>
                            <option value="åŠå¹´ä»¥å†…">åŠå¹´ä»¥å†…</option>
                            <option value="è‰¯ã„æ±‚äººãŒã‚ã‚Œã°">è‰¯ã„æ±‚äººãŒã‚ã‚Œã°</option>
                            <option value="ã¾ãšã¯æƒ…å ±åé›†">ã¾ãšã¯æƒ…å ±åé›†</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label>è»¢è·ã§æœ€ã‚‚é‡è¦–ã™ã‚‹ã“ã¨ <span class="required">å¿…é ˆ</span></label>
                        <select id="transferPriority" name="transferPriority" required>
                            <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                            <option value="åå…¥ã‚¢ãƒƒãƒ—ï¼ˆä»Šã‚ˆã‚Šè‰¯ã„çµ¦ä¸ï¼‰">åå…¥ã‚¢ãƒƒãƒ—ï¼ˆä»Šã‚ˆã‚Šè‰¯ã„çµ¦ä¸ï¼‰</option>
                            <option value="ãƒ¯ãƒ¼ã‚¯ãƒ©ã‚¤ãƒ•ãƒãƒ©ãƒ³ã‚¹ï¼ˆå­è‚²ã¦ã¨ä¸¡ç«‹ï¼‰">ãƒ¯ãƒ¼ã‚¯ãƒ©ã‚¤ãƒ•ãƒãƒ©ãƒ³ã‚¹ï¼ˆå­è‚²ã¦ã¨ä¸¡ç«‹ï¼‰</option>
                            <option value="é›‡ç”¨ã®å®‰å®šï¼ˆæ­£ç¤¾å“¡å¸Œæœ›ï¼‰">é›‡ç”¨ã®å®‰å®šï¼ˆæ­£ç¤¾å“¡å¸Œæœ›ï¼‰</option>
                            <option value="åƒãã‚„ã™ã„ç’°å¢ƒï¼ˆç†è§£ã‚ã‚‹è·å ´ï¼‰">åƒãã‚„ã™ã„ç’°å¢ƒï¼ˆç†è§£ã‚ã‚‹è·å ´ï¼‰</option>
                            <option value="ã‚­ãƒ£ãƒªã‚¢ã‚¢ãƒƒãƒ—ï¼ˆã‚¹ã‚­ãƒ«ã‚’æ´»ã‹ã™ãƒ»ä¼¸ã°ã™ï¼‰">ã‚­ãƒ£ãƒªã‚¢ã‚¢ãƒƒãƒ—ï¼ˆã‚¹ã‚­ãƒ«ã‚’æ´»ã‹ã™ãƒ»ä¼¸ã°ã™ï¼‰</option>
                            <option value="å¾©è·ãƒ»å†å°±è·ï¼ˆãƒ–ãƒ©ãƒ³ã‚¯æ˜ã‘ï¼‰">å¾©è·ãƒ»å†å°±è·ï¼ˆãƒ–ãƒ©ãƒ³ã‚¯æ˜ã‘ï¼‰</option>
                        </select>
                    </div>
                    
                    <button type="submit" class="btn btn-primary">ç™»éŒ²ã™ã‚‹</button>
                </form>
            </div>
        </div>
        
        <!-- ãƒšãƒ¼ã‚¸3: ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚° -->
        <div class="page" id="page3">
            <div class="card">
                <div class="loading">
                    <div class="spinner"></div>
                    <p>ç™»éŒ²ä¸­...</p>
                </div>
            </div>
        </div>
        
        <!-- ãƒšãƒ¼ã‚¸4: å®Œäº† -->
        <div class="page" id="page4">
            <div class="card">
                <div class="complete-icon">
                    <div class="checkmark">
                        <svg viewBox="0 0 24 24">
                            <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z"/>
                        </svg>
                    </div>
                </div>
                
                <div class="complete-message">
                    <h2>ç™»éŒ²å®Œäº†ï¼</h2>
                    <p>ä¼šå“¡ç™»éŒ²ãŒå®Œäº†ã—ã¾ã—ãŸã€‚<br>ã”ç™»éŒ²ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚</p>
                </div>
                
                <div class="info-card">
                    <h3>ğŸ“… æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—</h3>
                    <p>ã‚­ãƒ£ãƒªã‚¢ã‚«ã‚¦ãƒ³ã‚»ãƒ©ãƒ¼ã¨ã®é¢è«‡äºˆç´„ãŒã§ãã¾ã™ã€‚<br>é¢è«‡ã§ã¯ã€ã‚ãªãŸã«ã´ã£ãŸã‚Šã®ãŠä»•äº‹ã‚’ã”ç´¹ä»‹ã„ãŸã—ã¾ã™ã€‚</p>
                </div>
                
                <button class="btn btn-primary" onclick="goToAppointment()">é¢è«‡äºˆç´„ã¸é€²ã‚€</button>
                <button class="btn btn-secondary" onclick="closeLiff()">å¾Œã§äºˆç´„ã™ã‚‹</button>
            </div>
        </div>
    </div>

    <script>
        // è¨­å®š
        const CONFIG = {
            LIFF_ID: '2008409890-bdVxpkD0'  // æœ¬ç•ªç”¨LIFF ID
        };

        // ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°
        let lineProfile = null;

        // LIFFåˆæœŸåŒ–
        window.addEventListener('load', async () => {
            try {
                console.log('LIFFåˆæœŸåŒ–é–‹å§‹...');
                await liff.init({ liffId: CONFIG.LIFF_ID });
                console.log('LIFFåˆæœŸåŒ–æˆåŠŸ');
                console.log('isInClient:', liff.isInClient());
                console.log('isLoggedIn:', liff.isLoggedIn());

                // ãƒ­ã‚°ã‚¤ãƒ³æ¸ˆã¿ã‹ãƒã‚§ãƒƒã‚¯
                if (liff.isLoggedIn()) {
                    // ãƒ­ã‚°ã‚¤ãƒ³æ¸ˆã¿ - ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«å–å¾—
                    lineProfile = await liff.getProfile();
                    console.log('LINE Profile:', lineProfile);
                    
                    // ãƒ­ã‚°ã‚¤ãƒ³è©¦è¡Œãƒ•ãƒ©ã‚°ã‚’ã‚¯ãƒªã‚¢
                    sessionStorage.removeItem('liff_login_attempted');
                } else {
                    // æœªãƒ­ã‚°ã‚¤ãƒ³
                    console.log('æœªãƒ­ã‚°ã‚¤ãƒ³');
                    
                    // ç„¡é™ãƒ«ãƒ¼ãƒ—é˜²æ­¢: ã™ã§ã«ãƒ­ã‚°ã‚¤ãƒ³è©¦è¡Œæ¸ˆã¿ã‹ãƒã‚§ãƒƒã‚¯
                    const loginAttempted = sessionStorage.getItem('liff_login_attempted');
                    
                    if (loginAttempted) {
                        // ã™ã§ã«ãƒ­ã‚°ã‚¤ãƒ³è©¦è¡Œæ¸ˆã¿ - ãƒ­ã‚°ã‚¤ãƒ³ãƒœã‚¿ãƒ³ã‚’è¡¨ç¤º
                        console.log('ãƒ­ã‚°ã‚¤ãƒ³è©¦è¡Œæ¸ˆã¿ - æ‰‹å‹•ãƒ­ã‚°ã‚¤ãƒ³ãƒœã‚¿ãƒ³ã‚’è¡¨ç¤º');
                        showLoginButton();
                    } else {
                        // åˆå› - è‡ªå‹•ãƒ­ã‚°ã‚¤ãƒ³è©¦è¡Œ
                        console.log('åˆå›ãƒ­ã‚°ã‚¤ãƒ³è©¦è¡Œ');
                        sessionStorage.setItem('liff_login_attempted', 'true');
                        liff.login({ redirectUri: window.location.href });
                    }
                }

            } catch (error) {
                console.error('LIFF initialization failed:', error);
                showError('åˆæœŸåŒ–ã«å¤±æ•—ã—ã¾ã—ãŸã€‚ãƒšãƒ¼ã‚¸ã‚’å†èª­ã¿è¾¼ã¿ã—ã¦ãã ã•ã„ã€‚');
            }
        });

        // æ‰‹å‹•ãƒ­ã‚°ã‚¤ãƒ³ãƒœã‚¿ãƒ³ã‚’è¡¨ç¤º
        function showLoginButton() {
            const container = document.querySelector('.container');
            const loginCard = document.createElement('div');
            loginCard.className = 'card';
            loginCard.id = 'loginCard';
            loginCard.innerHTML = `
                <div style="text-align: center; padding: 20px;">
                    <h2 style="margin-bottom: 20px;">ğŸ” LINEãƒ­ã‚°ã‚¤ãƒ³</h2>
                    <p style="color: #666; line-height: 1.8; margin-bottom: 30px;">
                        ã‚µãƒ¼ãƒ“ã‚¹ã‚’åˆ©ç”¨ã™ã‚‹ã«ã¯<br>LINEãƒ­ã‚°ã‚¤ãƒ³ãŒå¿…è¦ã§ã™ã€‚
                    </p>
                    <button class="btn btn-primary" onclick="manualLogin()" style="margin-top: 0;">
                        LINEã§ãƒ­ã‚°ã‚¤ãƒ³
                    </button>
                    <p style="color: #888; font-size: 0.85em; margin-top: 20px;">
                        â€» LINEã‚¢ãƒ—ãƒªå†…ã§é–‹ãã¨<br>è‡ªå‹•çš„ã«ãƒ­ã‚°ã‚¤ãƒ³ã•ã‚Œã¾ã™
                    </p>
                </div>
            `;
            
            // æ—¢å­˜ã®ãƒšãƒ¼ã‚¸ã‚’éè¡¨ç¤ºã«ã—ã¦ãƒ­ã‚°ã‚¤ãƒ³ã‚«ãƒ¼ãƒ‰ã‚’è¡¨ç¤º
            document.querySelectorAll('.page').forEach(page => {
                page.style.display = 'none';
            });
            container.insertBefore(loginCard, container.firstChild.nextSibling);
        }

        // æ‰‹å‹•ãƒ­ã‚°ã‚¤ãƒ³
        function manualLogin() {
            sessionStorage.setItem('liff_login_attempted', 'true');
            liff.login({ redirectUri: window.location.href });
        }

        // åŒæ„ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã®çŠ¶æ…‹å¤‰æ›´
        function checkConsent() {
            const checkbox = document.getElementById('consent');
            const button = document.getElementById('agreeBtn');
            button.disabled = !checkbox.checked;
        }

        // ãƒšãƒ¼ã‚¸é·ç§»
        function showPage(pageNum) {
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            document.getElementById('page' + pageNum).classList.add('active');
            window.scrollTo(0, 0);
        }

        // ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡
        async function submitForm(event) {
            event.preventDefault();
            
            showPage(3); // ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ç”»é¢ã‚’è¡¨ç¤º

            try {
                // å¹´é½¢ã‚’è¨ˆç®—
                const birthDate = document.getElementById('birthDate').value;
                const age = calculateAge(birthDate);

                // å§“åã‚’çµåˆã—ã¦ name ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«è¨­å®š
                const lastName = document.getElementById('lastName').value;
                const firstName = document.getElementById('firstName').value;
                const fullName = lastName + ' ' + firstName;

                // ãƒ¬ã‚³ãƒ¼ãƒ‰ãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆï¼ˆkintoneã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚³ãƒ¼ãƒ‰ã«åˆã‚ã›ã‚‹ï¼‰
                const record = {
                    line_user_id: { value: lineProfile?.userId || '' },
                    line_display_name: { value: lineProfile?.displayName || '' },
                    profile_image_url: { value: lineProfile?.pictureUrl || '' },
                    name: { value: fullName },
                    last_name: { value: lastName },
                    first_name: { value: firstName },
                    last_name_kana: { value: document.getElementById('lastNameKana').value },
                    first_name_kana: { value: document.getElementById('firstNameKana').value },
                    birth_date: { value: birthDate },
                    age: { value: age.toString() },
                    gender: { value: document.querySelector('input[name="gender"]:checked')?.value || '' },
                    marital_status: { value: document.querySelector('input[name="maritalStatus"]:checked')?.value || '' },
                    children_count: { value: document.getElementById('childrenCount').value },
                    youngest_child_birth_year: { value: document.getElementById('youngestChildYear').value },
                    phone: { value: document.getElementById('phone').value },
                    email: { value: document.getElementById('email').value },
                    prefecture: { value: document.getElementById('prefecture').value },
                    desired_start_date: { value: document.getElementById('desiredStartDate').value },
                    transfer_priority: { value: document.getElementById('transferPriority').value },
                    status: { value: 'ä»®ç™»éŒ²' }
                };

                console.log('Submitting record:', record);

                // Serverless FunctionçµŒç”±ã§kintoneã«ç™»éŒ²
                const response = await fetch('/api/register', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ record: record })
                });

                const result = await response.json();
                console.log('Registration result:', result);

                if (!response.ok || !result.success) {
                    throw new Error(result.error || 'ç™»éŒ²ã«å¤±æ•—ã—ã¾ã—ãŸ');
                }

                // æˆåŠŸ - å®Œäº†ç”»é¢ã¸
                showPage(4);

            } catch (error) {
                console.error('Registration error:', error);
                showError('ç™»éŒ²ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: ' + error.message);
                showPage(2); // ãƒ•ã‚©ãƒ¼ãƒ ç”»é¢ã«æˆ»ã‚‹
            }
        }

        // å¹´é½¢è¨ˆç®—
        function calculateAge(birthDate) {
            const today = new Date();
            const birth = new Date(birthDate);
            let age = today.getFullYear() - birth.getFullYear();
            const monthDiff = today.getMonth() - birth.getMonth();
            
            if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < birth.getDate())) {
                age--;
            }
            
            return age;
        }

        // ã‚¨ãƒ©ãƒ¼è¡¨ç¤º
        function showError(message) {
            const errorElement = document.getElementById('errorMessage');
            errorElement.textContent = message;
            errorElement.classList.add('active');
            
            setTimeout(() => {
                errorElement.classList.remove('active');
            }, 5000);
        }

        // é¢è«‡äºˆç´„ç”»é¢ã¸é·ç§»
        function goToAppointment() {
            window.location.href = '/appointment.html';
        }

        // LIFFã‚’é–‰ã˜ã‚‹
        function closeLiff() {
            if (liff.isInClient()) {
                liff.closeWindow();
            } else {
                alert('ã”ç™»éŒ²ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸï¼');
            }
        }
    </script>
</body>
</html>
